import win32com.client

# Создаем COM-объект nanoCAD
ncad = win32com.client.Dispatch("nanoCAD.Application")

# Получаем доступ к активному документу
doc = ncad.ActiveDocument

try:
    # Создаем новый трубопровод
    pipeline = doc.ModelSpace.AddCustomObject("ModelPipeline")

    # Создаем начальный терминатор
    start_terminator = pipeline.WrTerminators.Add()
    start_terminator.Position = ncad.Point(0, 0, 0)

    # Создаем сегмент трубы
    segment = pipeline.WrSegments.Add()
    segment.PointStart = start_terminator.Position
    segment.PointEnd = ncad.Point(100, 100, 0)
    segment.Diameter = 50

    # Создаем конечный терминатор
    end_terminator = pipeline.WrTerminators.Add()
    end_terminator.Position = segment.PointEnd

    print("Труба успешно создана")

    # Обновляем модель
    doc.ModelUpdate()
    print("Модель обновлена")

    # Выводим информацию о созданной трубе
    print(f"Начальный терминатор: {start_terminator.Position}")
    print(f"Сегмент трубы: от {segment.PointStart} до {segment.PointEnd}")
    print(f"Конечный терминатор: {end_terminator.Position}")

except Exception as e:
    print(f"Ошибка при создании трубы: {e}")

# Не забудьте освободить COM-объекты
del doc
del ncad
