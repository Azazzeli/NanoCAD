import win32com.client

# Создаем COM-объект nanoCAD
ncad = win32com.client.Dispatch("nanoCAD.Application")

# Получаем доступ к активному документу
doc = ncad.ActiveDocument

try:
    # Создаем новый трубопровод
    pipeline = doc.ModelPipeline.Create()

    # Создаем первый сегмент трубы
    segment1 = pipeline.WrSegments.Add()
    segment1.StartPoint = ncad.Point(0, 0, 0)
    segment1.EndPoint = ncad.Point(100, 0, 0)
    segment1.Diameter = 50

    # Создаем второй сегмент трубы
    segment2 = pipeline.WrSegments.Add()
    segment2.StartPoint = segment1.EndPoint
    segment2.EndPoint = ncad.Point(100, 100, 0)
    segment2.Diameter = 50

    # Добавляем отвод (колено) между сегментами
    elbow = pipeline.WrElbows.Add()
    elbow.StartPoint = segment1.EndPoint
    elbow.EndPoint = segment2.StartPoint
    elbow.Diameter = 50
    elbow.Angle = 90  # угол в градусах

    print("Трубопровод успешно создан")

    # Обновляем модель
    doc.ModelUpdate()
    print("Модель обновлена")

except Exception as e:
    print(f"Ошибка при создании трубопровода: {e}")

# Не забудьте освободить COM-объекты
del doc
del ncad
