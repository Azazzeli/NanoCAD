def cut_corner(self):
    try:
        nanoCAD = win32com.client.Dispatch("NanoCAD.Application")
        doc = nanoCAD.ActiveDocument
        modelSpace = doc.ModelSpace

        cut_width = float(self.cutWidthInput.text())
        cut_length = float(self.cutLengthInput.text())
        target = self.cutTarget.currentText()

        if target == "Основная панель":
            panel_thickness = float(self.thicknessInput.text())
            panel = self.panel
        else:  # Изоляция
            panel_thickness = float(self.isolationThicknessInput.text())
            panel = self.isolation

        print(f"Укажите угол для подрезки в {target}:")
        cut_point = doc.Utility.GetPoint()

        # Получаем размеры и ориентацию панели
        min_point = panel.GetBoundingBox()[0]
        max_point = panel.GetBoundingBox()[1]
        panel_width = max_point[0] - min_point[0]
        panel_height = max_point[2] - min_point[2]  # Используем Z вместо Y для высоты

        # Определяем, какой размер больше: ширина или высота
        is_vertical = panel_height > panel_width

        # Создаем куб для подрезки
        if is_vertical:
            cut_box = modelSpace.AddBox(cut_point, cut_width * 2, panel_thickness * 2, cut_length * 2)
        else:
            cut_box = modelSpace.AddBox(cut_point, cut_width * 2, cut_length * 2, panel_thickness * 2)

        result = panel.Boolean(2, cut_box)
        doc.Regen(1)

        print(f'Выполнена подрезка угла размером {cut_width}x{cut_length} в {target}')
    except Exception as e:
        self.show_error_message(f'Произошла ошибка при подрезке угла: {str(e)}')
    finally:
        if 'doc' in locals():
            doc = None
        if 'nanoCAD' in locals():
            nanoCAD = None

def create_hole(self):
    try:
        nanoCAD = win32com.client.Dispatch("NanoCAD.Application")
        doc = nanoCAD.ActiveDocument
        modelSpace = doc.ModelSpace

        diameter = float(self.holeDiameterInput.text())
        target = self.holeTarget.currentText()

        if target == "Основная панель":
            panel = self.panel
            thickness = float(self.thicknessInput.text())
        else:  # Изоляция
            panel = self.isolation
            thickness = float(self.isolationThicknessInput.text())

        if panel is None:
            raise ValueError(f"{target} не создана")

        # Получаем размеры и ориентацию панели
        min_point = panel.GetBoundingBox()[0]
        max_point = panel.GetBoundingBox()[1]
        panel_width = max_point[0] - min_point[0]
        panel_height = max_point[2] - min_point[2]  # Используем Z вместо Y для высоты

        print(f"Укажите центр отверстия в {target}:")
        center_point = doc.Utility.GetPoint()

        # Создаем цилиндр с высотой, равной толщине панели
        cylinder = modelSpace.AddCylinder(center_point, diameter / 2, thickness)

        result = panel.Boolean(2, cylinder)
        doc.Regen(1)

        print(f'Создано отверстие диаметром {diameter} в {target} в точке {center_point}')
    except Exception as e:
        self.show_error_message(f'Произошла ошибка при создании отверстия: {str(e)}')
    finally:
        if 'doc' in locals():
            doc = None
        if 'nanoCAD' in locals():
            nanoCAD = None

def create_rectangular_cutout(self):
    try:
        width = float(self.cutoutWidthInput.text())
        height = float(self.cutoutHeightInput.text())
        x = float(self.cutoutXInput.text())
        y = float(self.cutoutYInput.text())

        nanoCAD = win32com.client.Dispatch("NanoCAD.Application")
        doc = nanoCAD.ActiveDocument
        modelSpace = doc.ModelSpace

        if self.panel is None or self.isolation is None:
            raise ValueError("Панель или изоляция не созданы")

        # Получаем размеры и ориентацию панели
        min_point = self.panel.GetBoundingBox()[0]
        max_point = self.panel.GetBoundingBox()[1]
        panel_width = max_point[0] - min_point[0]
        panel_height = max_point[2] - min_point[2]  # Используем Z вместо Y для высоты
        panel_thickness = max_point[1] - min_point[1]

        # Определяем, какой размер больше: ширина или высота
        is_vertical = panel_height > panel_width

        # Создаем куб для выреза
        if is_vertical:
            cutout = modelSpace.AddBox((x, min_point[1], y), width, panel_thickness, height)
        else:
            cutout = modelSpace.AddBox((x, y, min_point[2]), width, height, panel_thickness)

        self.panel.Boolean(2, cutout)
        self.isolation.Boolean(2, cutout)

        doc.Regen(1)
        print(f'Создан прямоугольный вырез размером {width}x{height} в позиции ({x}, {y})')
    except Exception as e:
        self.show_error_message(f'Произошла ошибка при создании выреза: {str(e)}')
    finally:
        if 'doc' in locals():
            doc = None
        if 'nanoCAD' in locals():
            nanoCAD = None
