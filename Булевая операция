 import win32com.client

try:
    # Создаем экземпляр приложения НаноКАД
    nanoCAD = win32com.client.Dispatch("NanoCAD.Application")
    print("НаноКАД успешно запущен")

    # Получаем активный документ
    doc = nanoCAD.ActiveDocument
    print("Активный документ получен")

    # Получаем пространство модели
    modelSpace = doc.ModelSpace

    # Создаем куб
    cube = modelSpace.AddBox((0, 0, 0), 50, 50, 50)
    print("Создан куб")

    # Создаем сферу
    sphere = modelSpace.AddSphere((25, 25, 25), 20)
    print("Создана сфера")

    # Выполняем булеву операцию вычитания
    result = cube.Boolean(2, sphere)  # 2 - операция вычитания
    print("Выполнена булева операция вычитания")

    # Обновляем экран
    doc.Regen(1)

    print("Операция успешно выполнена")

except Exception as e:
    print(f"Произошла ошибка: {str(e)}")
    
    # Дополнительная информация об ошибке
    import sys
    exc_type, exc_value, exc_traceback = sys.exc_info()
    print("Тип ошибки:", exc_type)
    print("Значение ошибки:", exc_value)
    print("Трассировка:")
    import traceback
    traceback.print_tb(exc_traceback)

finally:
    # Освобождаем COM-объекты
    if 'doc' in locals():
        doc = None
    if 'nanoCAD' in locals():
        nanoCAD = None
    print("COM-объекты освобождены")
